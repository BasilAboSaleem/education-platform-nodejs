<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard - Students</title>
    <link rel="stylesheet" href="/assets/vendors/feather/feather.css" />
    <link rel="stylesheet" href="/assets/vendors/mdi/css/materialdesignicons.min.css" />
    <link rel="stylesheet" href="/assets/vendors/css/vendor.bundle.base.css" />
    <link rel="stylesheet" href="/assets/vendors/ti-icons/css/themify-icons.css" />
    <link rel="stylesheet" href="/assets/vendors/simple-line-icons/css/simple-line-icons.css" />
    <link rel="stylesheet" href="/assets/css/style.css" />
  </head>

  <body class="with-welcome-text">
    <div class="container-scroller">
      <%- include('../../../partials/starAdminpartials/_navbar.ejs') %>

      <div class="container-fluid page-body-wrapper">
        <%- include('../../../partials/starAdminpartials/_sidebar.ejs') %>

        <div class="container" style="margin-top: 50px;">
          <div class="row justify-content-center">
            <div class="col-lg-8 col-md-10">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title text-center mb-4">Edit Course</h4>

                  <form action="/teacher/courses/edit/<%= course._id %>?_method=PUT" method="POST" enctype="multipart/form-data">
                    <div class="form-group mb-3">
                      <label for="name">Course Name</label>
                      <input type="text" name="title" id="name" value="<%= course.title %>" class="form-control" required />
                    </div>

                    <div class="form-group mb-3">
                      <label for="description">Description</label>
                      <input type="text" name="description" id="description" value="<%= course.description %>" class="form-control" required />
                    </div>


                    <div class="form-group mb-3">
                      <label for="image">Course Image</label>
                      <% if (course.image) { %>
                        <div class="mb-2">
                          <img src="<%= course.image %>" alt="Current Image" style="width: 150px; height: 150px; object-fit: cover; border-radius: 8px;" />
                        </div>
                      <% } %>
                      <input type="file" name="image" id="image" class="form-control" />
                    </div>

                    <div class="form-group mb-3">
                      <label for="category">Category</label>
                      <select class="form-control text-dark bg-white" name="category" id="category" required>
                        <option disabled selected>Select category</option>
                        <% categories.forEach(cat => { %>
                          <option value="<%= cat._id %>"><%= cat.name %></option>
                        <% }) %>
                      </select>
                    </div>

                    <div class="form-group">
                      <label for="createdAt">Created At</label>
                      <input type="text" class="form-control" id="createdAt" value="<%= moment(course.createdAt).format('YYYY-MM-DD') %>" readonly />
                    </div>

                    <div class="form-group">
                      <label for="updatedAt">Updated At</label>
                      <input type="text" class="form-control" id="updatedAt" value="<%= moment(course.updatedAt).format('YYYY-MM-DD') %>" readonly />
                    </div>

                    <div class="row mt-4 align-items-stretch">
                      <!-- Save & Manage (66%) -->
                      <div class="col-md-8 d-flex gap-2">
                        <form action="/teacher/courses/edit/<%= course._id %>?_method=PUT" method="POST" >
                        <button type="submit" class="btn btn-primary w-50 btn-custom">
                          <i class="mdi mdi-content-save"></i> Save
                        </button>
                      </form>
                        <a href="/teacher/courses/<%= course._id %>/lessons" class="btn btn-outline-primary w-50 btn-custom d-flex justify-content-center align-items-center text-center">
                          <i class="mdi mdi-book-open-page-variant me-1"></i> Manage Lessons
                        </a>
                      </div>
                    
                      <!-- Delete & Cancel (33%) -->
                      <div class="col-md-4 d-flex gap-2 mt-2 mt-md-0">
                        <form action="/teacher/courses/delete/<%= course._id %>?_method=DELETE" method="POST" onsubmit="return confirm('Are you sure you want to delete this course?');" class="w-50">
                          <button type="submit" class="btn btn-danger w-100 btn-custom">
                            <i class="mdi mdi-delete"></i> Delete
                          </button>
                        </form>
                        <a href="/teacher/courses" class="btn btn-secondary w-50 btn-custom">
                          <i class="mdi mdi-cancel"></i> Cancel
                        </a>
                      </div>
                    </div>
                    
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Style -->
    <style>
      .card-title {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 20px;
      }

      .btn {
        font-size: 16px;
        padding: 10px 20px;
      }

      .btn-lg {
        font-size: 18px;
        padding: 12px 28px;
      }

      .btn-sm {
        font-size: 14px;
        padding: 6px 16px;
      }

      .btn i {
        margin-right: 5px;
      }

      .d-flex form,
      .d-flex a,
      .d-flex button {
        margin: 0;
      }
    </style>

    <!-- Scripts -->
    <script src="/assets/vendors/js/vendor.bundle.base.js"></script>
    <script src="/assets/vendors/bootstrap-datepicker/bootstrap-datepicker.min.js"></script>
    <script src="/assets/vendors/chart.js/chart.umd.js"></script>
    <script src="/assets/vendors/progressbar.js/progressbar.min.js"></script>
    <script src="/assets/js/off-canvas.js"></script>
    <script src="/assets/js/template.js"></script>
    <script src="/assets/js/settings.js"></script>
    <script src="/assets/js/hoverable-collapse.js"></script>
    <script src="/assets/js/todolist.js"></script>
    <script src="/assets/js/dashboard.js"></script>
    <script src="/assets/js/jquery.cookie.js" type="text/javascript"></script>
  </body>
</html>
